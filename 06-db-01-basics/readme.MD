# Домашнее задание к занятию "6.1. Типы и структура СУБД"

## Введение

Перед выполнением задания вы можете ознакомиться с 
[дополнительными материалами](https://github.com/netology-code/virt-homeworks/tree/master/additional/README.md).

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- Электронные чеки в json виде
- Склады и автомобильные дороги для логистической компании
- Генеалогические деревья
- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
- Отношения клиент-покупка для интернет-магазина

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

### Ответ
- Электронные чеки в json виде  
Учитывая формат json логично использовать любую документоориентированную СУБД. 
Но исходя из требований к нашему законодательству и необходимый обмен с вездесущей 1С и ФНС 
то возможно что , и реляционная будет правильным решением - выбор конкретной СУБД зависит от
уже используемых в организации. json входящий придется парсить, а исходящий формировать динамически.  

- Склады и автомобильные дороги для логистической компании  
Графовая СУБД. Логичным будет динамическое изменение свойств ребер и вершин (дорожная, погодная обстановка, наличие, количество нужного товара на складе и т.п.) и оптимизация движка СУБД под решение задач теории графов (напр., построение оптимального маршрута).  

- Генеалогические деревья  
Иерархическая БД, т.к посути генелогическое дерево и есть иерархическая база данных
 

- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации  
Однозначно key-value.

- Отношения клиент-покупка для интернет-магазина  
Реляционная БД. Из витееватой постановки вопроса следует что нужна БД для CRM системы.
А без сложной аналитики по продажам ее представить сложно 
###

## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)
- При сетевых сбоях, система может разделиться на 2 раздельных кластера
- Система может не прислать корректный ответ или сбросить соединение

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

### Ответ
- Данные записываются на все узлы с задержкой до часа (асинхронная запись)  
AP - так как Consistency отсутствует. 

- При сетевых сбоях, система может разделиться на 2 раздельных кластера  
AP. Сохраняется доступность и имеется устойчивость к разделению.

- Система может не прислать корректный ответ или сбросить соединение  
Availability не выполнено, стало быть, CP (или просто C, или просто P -недостаточно данных).

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?  
Недостаточно данных. Первая система P?/EC, вторая PA/E?, третья P?/EC
###

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

### Ответ
Скорее всего нет, не может. На принципе ACID проектируются и строятся высоконадежные системы. 
Принцип на первое место ставит надежность и целостность. Принцип BASE позволяет строить высокопроизводительные системы. 
На первое место выдвигается скорость обработке данных в ущерб целостности и доступности.
###

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни
- реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/). 
Что это за система? Какие минусы выбора данной системы?

### Ответ
Redis Stream. 
Минусы выбора следующие:
- Издатель может перегрузить работой своих подписчиков, если данные публикуются быстрее, чем обрабатываются
- Все подписчики получат сообщение одновременно. Подписчики сами должны как-то между собой согласовывать порядок обработки одного и того же сообщения.
- Нет встроенного механизма подтверждения успешной обработки сообщения подписчиком. Если подписчик получил сообщение и свалился во время обработки, то издатель об этом не узнает.
###

---
